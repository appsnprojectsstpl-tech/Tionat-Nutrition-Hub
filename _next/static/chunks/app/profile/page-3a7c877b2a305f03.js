(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6636],{8221:(e,s,r)=>{Promise.resolve().then(r.bind(r,10256))},10256:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>H});var t=r(95155),a=r(12115),l=r(6874),n=r.n(l),i=r(62177),d=r(90221),o=r(55594),c=r(85977),m=r(59434);let x=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)(c.bL,{ref:s,className:(0,m.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...a})});x.displayName=c.bL.displayName;let u=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)(c._V,{ref:s,className:(0,m.cn)("aspect-square h-full w-full",r),...a})});u.displayName=c._V.displayName;let h=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)(c.H4,{ref:s,className:(0,m.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...a})});h.displayName=c.H4.displayName;var f=r(26126),j=r(30285),p=r(66695),N=r(54165),g=r(17759),y=r(85127),b=r(62523),v=r(18186),w=r(18763),A=r(77223),T=r(45731),R=r(33349),S=r(34301),C=r(30462),k=r(73158),_=r(40768),E=r(35317),I=r(35695),D=r(52955),B=r(87481),O=r(64190),M=r(93004),L=r(14265),F=r(40154);function P(e){let{onDelete:s,onRefetch:r}=e,{savedAddresses:a}=(0,F.U)(),l=Array.from(new Set(a));return l&&0!==l.length?(0,t.jsx)(t.Fragment,{children:l.map((e,a)=>(0,t.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(v.A,{className:"h-5 w-5 text-muted-foreground"}),(0,t.jsx)("p",{className:"text-sm",children:e})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(L.b,{address:e,onSave:r,children:(0,t.jsx)(j.$,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,t.jsx)(w.A,{className:"h-4 w-4"})})}),(0,t.jsx)(j.$,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:()=>s(e),children:(0,t.jsx)(A.A,{className:"h-4 w-4"})})]})]},"".concat(e,"-").concat(a)))}):(0,t.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No addresses saved yet. Add your first delivery address."})}let z=o.Ik({firstName:o.Yj().min(1,"First name is required"),lastName:o.Yj().min(1,"Last name is required"),phoneNumber:o.Yj().optional(),avatarUrl:o.Yj().url().optional().or(o.eu(""))}),U={Bronze:"bg-orange-200 text-orange-800",Silver:"bg-slate-200 text-slate-800",Gold:"bg-yellow-200 text-yellow-800"};function H(){var e,s;let{user:r,auth:l,isUserLoading:o}=(0,_.useAuth)(),c=(0,_.useFirestore)(),v=(0,I.useRouter)(),{toast:w}=(0,B.dj)(),[A,F]=(0,a.useState)(!1),H=(0,_.useMemoFirebase)(()=>c&&r?(0,E.doc)(c,"users",r.uid):null,[c,r]),{data:$,isLoading:Z,refetch:V}=(0,_.useDoc)(H),Y=(0,_.useMemoFirebase)(()=>c&&r?(0,E.query)((0,E.collection)(c,"users/".concat(r.uid,"/orders")),(0,E.orderBy)("orderDate","desc")):null,[c,r]),{data:W,isLoading:G}=(0,_.useCollection)(Y),q=(0,i.mN)({resolver:(0,d.u)(z),defaultValues:{firstName:"",lastName:"",phoneNumber:"",avatarUrl:""}});(0,a.useEffect)(()=>{$&&q.reset({firstName:$.firstName,lastName:$.lastName,phoneNumber:$.phoneNumber||"",avatarUrl:$.avatarUrl||""})},[$,q]);let J=async()=>{if(l)try{await (0,M.CI)(l),w({title:"Logged Out",description:"You have been successfully logged out."}),v.push("/")}catch(e){console.error("Error signing out: ",e),w({title:"Logout Failed",description:"An error occurred while logging out. Please try again.",variant:"destructive"})}};if(o||Z)return(0,t.jsx)("div",{className:"min-h-screen bg-background",children:(0,t.jsx)("main",{className:"container mx-auto px-4 py-8 text-center",children:(0,t.jsx)("p",{children:"Loading profile..."})})});if(!r)return(0,t.jsx)("div",{className:"min-h-screen bg-background",children:(0,t.jsxs)("main",{className:"container mx-auto px-4 py-8 text-center",children:[(0,t.jsx)("h1",{className:"text-2xl md:text-3xl font-bold font-headline mb-6",children:"Please Log In"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-8",children:"You need to be logged in to view your profile."}),(0,t.jsx)(j.$,{asChild:!0,children:(0,t.jsx)(n(),{href:"/login?redirect=/profile",children:"Login"})})]})});if(!$&&!Z)return(0,t.jsx)("div",{className:"min-h-screen bg-background",children:(0,t.jsxs)("main",{className:"container mx-auto px-4 py-8 text-center",children:[(0,t.jsx)("h1",{className:"text-2xl md:text-3xl font-bold font-headline mb-6",children:"Profile Not Found"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-8",children:"We couldn't find a profile for your account. This can sometimes happen after a new sign-up. Please try refreshing the page or contact support if the issue persists."}),(0,t.jsx)(j.$,{onClick:()=>window.location.reload(),children:"Refresh Page"})]})});if(!$&&Z)return(0,t.jsx)("div",{className:"min-h-screen bg-background",children:(0,t.jsx)("main",{className:"container mx-auto px-4 py-8 text-center",children:(0,t.jsx)("p",{children:"Loading profile..."})})});if(!$)return null;let X="admin"===$.role||"superadmin"===$.role;return(0,t.jsx)("div",{className:"min-h-screen bg-background",children:(0,t.jsx)("main",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)("div",{className:"grid gap-8 md:grid-cols-3",children:[(0,t.jsx)("div",{className:"md:col-span-1",children:(0,t.jsxs)(p.Zp,{children:[(0,t.jsxs)(p.aR,{className:"flex flex-col items-center text-center",children:[(0,t.jsxs)(x,{className:"w-24 h-24 mb-4",children:[$.avatarUrl&&(0,t.jsx)(u,{src:$.avatarUrl,alt:$.firstName}),(0,t.jsxs)(h,{children:[null==(e=$.firstName)?void 0:e.charAt(0),null==(s=$.lastName)?void 0:s.charAt(0)]})]}),(0,t.jsxs)(p.ZB,{className:"font-headline text-2xl",children:[$.firstName," ",$.lastName]}),(0,t.jsx)(p.BT,{children:$.email})]}),(0,t.jsxs)(p.Wu,{className:"flex flex-col items-center gap-2",children:[X&&(0,t.jsx)(j.$,{asChild:!0,className:"w-full",children:(0,t.jsxs)(n(),{href:"/admin",children:[(0,t.jsx)(T.A,{className:"mr-2 h-4 w-4"}),"Admin Dashboard"]})}),(0,t.jsxs)(N.lG,{open:A,onOpenChange:F,children:[(0,t.jsx)(N.zM,{asChild:!0,children:(0,t.jsx)(j.$,{variant:"outline",className:"w-full",children:"Edit Profile"})}),(0,t.jsxs)(N.Cf,{className:"sm:max-w-md",children:[(0,t.jsxs)(N.c7,{children:[(0,t.jsx)(N.L3,{children:"Edit Profile"}),(0,t.jsx)(N.rr,{children:"Update your personal information."})]}),(0,t.jsx)(g.lV,{...q,children:(0,t.jsxs)("form",{onSubmit:q.handleSubmit(e=>{H&&((0,D.wu)(H,e,{merge:!0}),w({title:"Profile Updated",description:"Your information has been successfully saved."}),F(!1))}),className:"space-y-4",children:[(0,t.jsx)(g.zB,{control:q.control,name:"firstName",render:e=>{let{field:s}=e;return(0,t.jsxs)(g.eI,{children:[(0,t.jsx)(g.lR,{children:"First Name"}),(0,t.jsx)(g.MJ,{children:(0,t.jsx)(b.p,{...s})}),(0,t.jsx)(g.C5,{})]})}}),(0,t.jsx)(g.zB,{control:q.control,name:"lastName",render:e=>{let{field:s}=e;return(0,t.jsxs)(g.eI,{children:[(0,t.jsx)(g.lR,{children:"Last Name"}),(0,t.jsx)(g.MJ,{children:(0,t.jsx)(b.p,{...s})}),(0,t.jsx)(g.C5,{})]})}}),(0,t.jsx)(g.zB,{control:q.control,name:"avatarUrl",render:e=>{let{field:s}=e;return(0,t.jsxs)(g.eI,{children:[(0,t.jsx)(g.lR,{children:"Avatar URL"}),(0,t.jsx)(g.MJ,{children:(0,t.jsx)(b.p,{placeholder:"https://example.com/avatar.png",...s})}),(0,t.jsx)(g.C5,{})]})}}),(0,t.jsx)(g.zB,{control:q.control,name:"phoneNumber",render:e=>{let{field:s}=e;return(0,t.jsxs)(g.eI,{children:[(0,t.jsx)(g.lR,{children:"Phone Number"}),(0,t.jsx)(g.MJ,{children:(0,t.jsx)(b.p,{placeholder:"e.g. 9876543210",...s})}),(0,t.jsx)(g.C5,{})]})}}),(0,t.jsxs)(N.Es,{children:[(0,t.jsx)(j.$,{type:"button",variant:"ghost",onClick:()=>F(!1),children:"Cancel"}),(0,t.jsx)(j.$,{type:"submit",children:"Save Changes"})]})]})})]})]}),(0,t.jsxs)(j.$,{variant:"ghost",size:"sm",onClick:J,className:"text-red-500 hover:text-red-600",children:[(0,t.jsx)(R.A,{className:"mr-2 h-4 w-4"}),"Logout"]})]})]})}),(0,t.jsxs)("div",{className:"md:col-span-2 space-y-8",children:[(0,t.jsxs)(p.Zp,{children:[(0,t.jsxs)(p.aR,{className:"flex flex-row items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(p.ZB,{className:"font-headline",children:"Manage Addresses"}),(0,t.jsx)(p.BT,{children:"Add or remove your delivery addresses."})]}),(0,t.jsx)(L.b,{onSave:V,children:(0,t.jsxs)(j.$,{variant:"outline",size:"sm",children:[(0,t.jsx)(S.A,{className:"mr-2 h-4 w-4"}),"Add New"]})})]}),(0,t.jsx)(p.Wu,{className:"space-y-4",children:(0,t.jsx)(P,{onDelete:e=>{H&&confirm("Are you sure you want to delete this address?")&&((0,D.pt)(H,{addresses:(0,E.arrayRemove)(e)}),w({title:"Address Removed",description:"The selected address has been deleted.",variant:"destructive"}),V())},onRefetch:V})})]}),(0,t.jsxs)(p.Zp,{children:[(0,t.jsx)(p.aR,{children:(0,t.jsxs)(p.ZB,{className:"flex items-center font-headline",children:[(0,t.jsx)(C.A,{className:"w-6 h-6 mr-2 text-yellow-500"}),"TioRewards Status"]})}),(0,t.jsxs)(p.Wu,{className:"grid gap-6 sm:grid-cols-2",children:[(0,t.jsx)("div",{className:"flex flex-col items-center justify-center p-6 bg-secondary rounded-lg",children:$.loyaltyTier?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(f.E,{className:(0,m.cn)("text-sm font-bold px-4 py-1",U[$.loyaltyTier]),children:[$.loyaltyTier," Tier"]}),(0,t.jsx)("p",{className:"text-muted-foreground mt-2 text-sm",children:"Gold"===$.loyaltyTier?"15% off + early access":"Silver"===$.loyaltyTier?"10% off + free shipping":"5% off basic perks"})]}):(0,t.jsx)("p",{className:"text-muted-foreground",children:"No tier yet."})}),(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center p-6 bg-secondary rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-baseline",children:[(0,t.jsx)("span",{className:"text-4xl font-bold",children:$.loyaltyPoints||0}),(0,t.jsx)("span",{className:"ml-2 text-muted-foreground",children:"Points"})]}),(0,t.jsx)("p",{className:"text-muted-foreground mt-2 text-sm",children:"100 points = 25 discount"})]})]})]}),(0,t.jsxs)(p.Zp,{children:[(0,t.jsxs)(p.aR,{children:[(0,t.jsx)(p.ZB,{className:"font-headline",children:"Order History"}),(0,t.jsx)(p.BT,{children:"View your past orders and their status."})]}),(0,t.jsx)(p.Wu,{children:(0,t.jsxs)(y.XI,{children:[(0,t.jsx)(y.A0,{children:(0,t.jsxs)(y.Hj,{children:[(0,t.jsx)(y.nd,{children:"Order ID"}),(0,t.jsx)(y.nd,{children:"Date"}),(0,t.jsx)(y.nd,{children:"Status"}),(0,t.jsx)(y.nd,{className:"text-right",children:"Total"}),(0,t.jsx)(y.nd,{children:(0,t.jsx)("span",{className:"sr-only",children:"View"})})]})}),(0,t.jsxs)(y.BF,{children:[G&&(0,t.jsx)(y.Hj,{children:(0,t.jsx)(y.nA,{colSpan:5,className:"text-center",children:"Loading orders..."})}),W&&W.length>0?W.map(e=>(0,t.jsxs)(y.Hj,{className:"cursor-pointer",onClick:()=>v.push("/profile/order-details?id=".concat(e.id)),children:[(0,t.jsxs)(y.nA,{className:"font-medium",children:["...",e.id.slice(-6)]}),(0,t.jsx)(y.nA,{children:e.orderDate?(0,O.GP)(e.orderDate.toDate(),"MMM d, yyyy"):"N/A"}),(0,t.jsx)(y.nA,{children:(0,t.jsx)(f.E,{variant:"Pending"===e.status?"secondary":"default",children:e.status})}),(0,t.jsx)(y.nA,{className:"text-right",children:e.totalAmount.toFixed(2)}),(0,t.jsx)(y.nA,{className:"text-right",children:(0,t.jsx)(k.A,{className:"h-4 w-4"})})]},e.id)):!G&&(0,t.jsx)(y.Hj,{children:(0,t.jsx)(y.nA,{colSpan:5,className:"text-center text-muted-foreground",children:"You haven't placed any orders yet."})})]})]})})]})]})]})})})}},30285:(e,s,r)=>{"use strict";r.d(s,{$:()=>o,r:()=>d});var t=r(95155),a=r(12115),l=r(66634),n=r(74466),i=r(59434);let d=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=a.forwardRef((e,s)=>{let{className:r,variant:a,size:n,asChild:o=!1,...c}=e,m=o?l.DX:"button";return(0,t.jsx)(m,{className:(0,i.cn)(d({variant:a,size:n,className:r})),ref:s,...c})});o.displayName="Button"},66695:(e,s,r)=>{"use strict";r.d(s,{BT:()=>o,Wu:()=>c,ZB:()=>d,Zp:()=>n,aR:()=>i,wL:()=>m});var t=r(95155),a=r(12115),l=r(59434);let n=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});n.displayName="Card";let i=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",r),...a})});i.displayName="CardHeader";let d=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});d.displayName="CardTitle";let o=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("text-sm text-muted-foreground",r),...a})});o.displayName="CardDescription";let c=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("p-6 pt-0",r),...a})});c.displayName="CardContent";let m=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",r),...a})});m.displayName="CardFooter"},85127:(e,s,r)=>{"use strict";r.d(s,{A0:()=>i,BF:()=>d,Hj:()=>o,XI:()=>n,nA:()=>m,nd:()=>c});var t=r(95155),a=r(12115),l=r(59434);let n=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{className:"relative w-full overflow-auto",children:(0,t.jsx)("table",{ref:s,className:(0,l.cn)("w-full caption-bottom text-sm",r),...a})})});n.displayName="Table";let i=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("thead",{ref:s,className:(0,l.cn)("[&_tr]:border-b",r),...a})});i.displayName="TableHeader";let d=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("tbody",{ref:s,className:(0,l.cn)("[&_tr:last-child]:border-0",r),...a})});d.displayName="TableBody",a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("tfoot",{ref:s,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...a})}).displayName="TableFooter";let o=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("tr",{ref:s,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...a})});o.displayName="TableRow";let c=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("th",{ref:s,className:(0,l.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...a})});c.displayName="TableHead";let m=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("td",{ref:s,className:(0,l.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...a})});m.displayName="TableCell",a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("caption",{ref:s,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",r),...a})}).displayName="TableCaption"},87481:(e,s,r)=>{"use strict";r.d(s,{dj:()=>x});var t=r(12115);let a=0,l=new Map,n=e=>{if(l.has(e))return;let s=setTimeout(()=>{l.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);l.set(e,s)},i=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=s;return r?n(r):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},d=[],o={toasts:[]};function c(e){o=i(o,e),d.forEach(e=>{e(o)})}function m(e){let{...s}=e,r=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),t=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...s,id:r,open:!0,onOpenChange:e=>{e||t()}}}),{id:r,dismiss:t,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function x(){let[e,s]=t.useState(o);return t.useEffect(()=>(d.push(s),()=>{let e=d.indexOf(s);e>-1&&d.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}}},e=>{var s=s=>e(e.s=s);e.O(0,[2992,3644,4277,2746,9934,3977,6602,5521,4190,6301,9123,1990,8441,1684,7358],()=>s(8221)),_N_E=e.O()}]);